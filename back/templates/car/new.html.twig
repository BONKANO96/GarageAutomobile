{% extends 'base.html.twig' %}

{% block title %}{{ car is defined ? 'Modifier' : 'Ajouter' }} une voiture{% endblock %}

{% block body %}
<div class="container mt-5">
    <h1 class="mb-4">{{ car is defined ? 'Modifier' : 'Ajouter' }} une voiture d'occasion</h1>
    <div class="card shadow-sm">
        <div class="card-body">
            {{ form_start(form) }}

                {# Affiche les erreurs globales du formulaire, s'il y en a #}
                {% if form.vars.errors is not empty %}
                    <div class="alert alert-danger">
                        {{ form_errors(form) }}
                    </div>
                {% endif %}

                <div class="mb-3">
                    {{ form_label(form.price) }}
                    {{ form_widget(form.price, {'attr': {'class': 'form-control'}}) }}
                    {{ form_errors(form.price) }}
                </div>

                <div class="mb-3">
                    {{ form_label(form.year) }}
                    {{ form_widget(form.year, {'attr': {'class': 'form-control'}}) }}
                    {{ form_errors(form.year) }}
                </div>

                <div class="mb-3">
                    {{ form_label(form.mileage) }}
                    {{ form_widget(form.mileage, {'attr': {'class': 'form-control'}}) }}
                    {{ form_errors(form.mileage) }}
                </div>

                <div class="mb-3">
                    {# Affichage du champ pour l'image principale #}
                    {{ form_label(form.mainImage) }}
                    {{ form_widget(form.mainImage, {'attr': {'class': 'form-control-file'}}) }}
                    {{ form_errors(form.mainImage) }}

                    {# Si l'image est déjà définie, l'afficher en prévisualisation #}
                    {% if car is defined and car.mainImageFilename %}
                        <img src="{{ asset('uploads/' ~ car.mainImageFilename) }}" alt="Image de la voiture" class="img-fluid mt-3">
                    {% endif %}
                </div>

                <div class="mb-3">
                    {# Affichage du champ pour la galerie d'images #}
                    {{ form_label(form.gallery) }}
                    {{ form_widget(form.gallery, {'attr': {'class': 'form-control-file'}}) }}
                    {{ form_errors(form.gallery) }}

                    {# Si des images dans la galerie sont déjà définies, les afficher en prévisualisation #}
                    {% if car is defined and car.gallery is not empty %}
                        <div class="mt-3">
                            {% for image in car.gallery %}
                                <img src="{{ asset('uploads/' ~ image) }}" alt="Image de la voiture" class="img-thumbnail" style="width: 100px;">
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>

                <div class="mb-3">
                    {{ form_label(form.description) }}
                    {{ form_widget(form.description, {'attr': {'class': 'form-control'}}) }}
                    {{ form_errors(form.description) }}
                </div>

                <div class="mb-3">
                    {{ form_label(form.features) }}
                    {{ form_widget(form.features) }}
                    {{ form_errors(form.features) }}
                </div>

                <div class="mb-3">
                    {{ form_label(form.options) }}
                    {{ form_widget(form.options) }}
                    {{ form_errors(form.options) }}
                </div>

                <button type="submit" class="btn btn-primary">Enregistrer</button>
                <a href="{{ path('app_car_index') }}" class="btn btn-secondary ms-2">Retour</a>

            {{ form_end(form) }}
        </div>
    </div>
</div>
{% endblock %}
